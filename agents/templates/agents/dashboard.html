{% extends 'agents/base.html' %}

{% block title %}–î–∞—à–±–æ—Ä–¥{% endblock %}

{% block content %}
<h1>–î–∞—à–±–æ—Ä–¥ —Å–∏—Å—Ç–µ–º—ã</h1>
<p class="welcome-text">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.username }}! üëã</p>

{% if agent %}
    <h2>–í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number">{{ total_sales }} ‚ÇΩ</div>
            <div>–û–±—ä–µ–º –ø—Ä–æ–¥–∞–∂</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ total_commission }} ‚ÇΩ</div>
            <div>–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ sales_count }}</div>
            <div>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–∂</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ agent.commission_rate }}%</div>
            <div>–í–∞—à –ø—Ä–æ—Ü–µ–Ω—Ç</div>
        </div>
    </div>

    {% if recent_sales %}
    <div class="card">
        <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–æ–¥–∞–∂–∏</h3>
        {% for sale in recent_sales %}
        <div style="padding: 1rem; border-bottom: 1px solid #eee; display: flex; justify-content: space-between;">
            <div>
                <strong>{{ sale.product.name }}</strong><br>
                <small>–ö–ª–∏–µ–Ω—Ç: {{ sale.client_name }}</small>
            </div>
            <div style="text-align: right;">
                <strong>{{ sale.total_amount }} ‚ÇΩ</strong><br>
                <small>–ö–æ–º–∏—Å—Å–∏—è: {{ sale.commission }} ‚ÇΩ</small>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

{% else %}
    <h2>–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number">{{ total_agents }}</div>
            <div>–í—Å–µ–≥–æ –∞–≥–µ–Ω—Ç–æ–≤</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ active_agents }}</div>
            <div>–ê–∫—Ç–∏–≤–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ total_sales }} ‚ÇΩ</div>
            <div>–û–±—â–∏–π –æ–±—ä–µ–º –ø—Ä–æ–¥–∞–∂</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ total_commission }} ‚ÇΩ</div>
            <div>–í—ã–ø–ª–∞—á–µ–Ω–æ –∫–æ–º–∏—Å—Å–∏–π</div>
        </div>
    </div>

    {% if user.is_staff %}
    <div class="card">
        <h3>–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
        <div style="display: flex; gap: 1rem; margin-top: 1rem;">
            <a href="{% url 'agent_list' %}" class="btn">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞–º–∏</a>
            <a href="{% url 'upload_presentation' %}" class="btn">–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é</a>
            <a href="/admin/" class="btn">–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</a>
        </div>
    </div>
    {% endif %}
{% endif %}

<div class="card">
    <h3>–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å–∏—Å—Ç–µ–º–µ</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
        <a href="{% url 'presentation_list' %}" class="btn" style="text-align: center;">
            üìö –û–±—É—á–∞—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
        </a>
        {% if user.is_staff %}
        <a href="{% url 'agent_list' %}" class="btn" style="text-align: center;">
            üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞–º–∏
        </a>
        <a href="/admin/" class="btn" style="text-align: center;">
            ‚öôÔ∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
        </a>
        {% endif %}
    </div>
</div>
{% endblock %}